# =============================================================================
# UNI-X VOICE TO VIDEO - PROMPTS CONFIGURATION v5.0 (AI PRODUCTION DIRECTOR)
# =============================================================================
# Theo chuan AI Production Director voi 3-Step Workflow:
# - Step 1: PACING & SLICING (segment text 8-20 words)
# - Step 2: DIRECTOR'S VISUAL BLUEPRINT (scene direction)
# - Step 3: PRODUCTION EXECUTION (assets + scene JSON)
#
# OUTPUT: JSON thuan, de parse va su dung
# =============================================================================

# =============================================================================
# GLOBAL STYLE DEFINITION (MASTER STRING - PASTE NGUYEN VAN)
# =============================================================================

global_style_string: "Cinematic, 4K photorealistic, shot on Arri Alexa, soft film grain, High Key Lighting, Balanced Exposure, well-lit, soft fill light, no crushing shadows, highly detailed texture, professional color grading"

visual_clarity_string: "Face illuminated by soft volumetric light, clear facial features, high visibility"

negative_prompt_string: "cartoon, 3d render, text, watermark, bad anatomy, distorted face, very dark image, underexposed, wrong face, different character, inconsistent appearance"

# =============================================================================
# STEP 1 + 2: ANALYZE STORY (Director's Vision + Character + Location Bible)
# =============================================================================
# Input: {story_text}
# Output: JSON voi world_setting, characters, locations
# =============================================================================

analyze_story: |
  Ban la AI Production Director (Dao dien). Phan tich kich ban va tao Production Kit.

  ## INPUT SCRIPT:
  ---
  {story_text}
  ---

  ## NHIEM VU - LAM THEO THU TU:

  ### BUOC 1: DIRECTOR'S VISION (PHAN TICH THE GIOI CAU CHUYEN TRUOC!)
  Doc ky cau chuyen va xac dinh:
  - **Era (Thoi dai)**: Hien dai? 1990s? 1970s? Thoi phong kien?
  - **Setting (Moi truong)**: Thanh thi? Nong thon? Mien nui? Ven bien?
  - **Social class (Tang lop)**: Giau co? Trung luu? Ngheo kho? Nong dan?
  - **Tone (Tone mau)**: Am ap? Lanh leo? U am? Tuoi sang?
  - **Region (Vung mien)**: Mien Bac? Mien Trung? Mien Nam? Tay Nguyen?

  TU WORLD SETTING NAY → Quyet dinh PHONG CACH cho nhan vat va boi canh!

  ### BUOC 2: CHARACTER BIBLE ("Cast" nhan vat PHU HOP voi the gioi)
  - Moi nhan vat PHAI phu hop voi world setting da xac dinh
  - Neu truyen nong thon ngheo → nhan vat mac ao ba ba, da ngam, toc gian di
  - Neu truyen thanh thi hien dai → nhan vat mac ao so mi, da sang, toc thoi trang
  - Neu truyen thoi xua → nhan vat mac ao dai/ao tu than, toc bui/tet

  ### BUOC 3: LOCATION BIBLE ("Scout" boi canh PHU HOP voi the gioi)
  - Moi boi canh PHAI phu hop voi world setting da xac dinh
  - Neu truyen nong thon → nha la, duong dat, dong lua, ao ca
  - Neu truyen thanh thi → chung cu, van phong, quan cafe, duong nhua
  - Neu truyen thoi xua → nha go, san dinh, chua chien

  ### BUOC 4: KEY OBJECTS (Chi liet ke neu co vat the dac biet)

  ## OUTPUT FORMAT - PURE JSON (khong markdown):

  {{
    "production_info": {{
      "title": "Ten cau chuyen",
      "genre": "Drama/Comedy/etc",
      "total_characters": 3,
      "total_locations": 2
    }},

    "world_setting": {{
      "era": "1990s rural Vietnam",
      "setting": "Nong thon mien Bac Viet Nam",
      "social_class": "Nong dan ngheo",
      "tone": "Am ap nhung buon man mac",
      "region": "Dong bang Bac Bo",
      "visual_style": "Warm earthy tones, golden hour lighting, rustic textures, weathered surfaces"
    }},

    "global_style": "Cinematic, 4K photorealistic, shot on Arri Alexa, soft film grain, warm earthy color palette, natural lighting, rustic Vietnamese aesthetic",

    "context_lock": "1990s rural Northern Vietnam, farming village, simple wooden houses with thatched roofs, dirt roads, rice paddies, warm golden afternoon light",

    "characters": [
      {{
        "id": "nvc",
        "name": "Toi (Nguoi ke chuyen)",
        "role": "main",
        "age": 35,
        "gender": "male",
        "is_child": false,
        "filename": "nvc.png",
        "portrait_prompt": "A cinematic portrait, straight-on medium close-up shot on 85mm lens. Subject is a 35-year-old Vietnamese farmer with weathered face, short black hair with some gray, dark tanned skin from sun exposure, gentle tired eyes. Looking directly at camera with neutral expression. Bright studio lighting, fully illuminated face. Pure white studio background. Wearing faded brown work shirt, simple and worn. 8K, sharp focus, photorealistic.",
        "character_lock": "35-year-old Vietnamese farmer, weathered tan face, short black hair with gray, tired gentle eyes, wearing faded brown cotton work shirt"
      }},
      {{
        "id": "nv1",
        "name": "Me",
        "role": "supporting",
        "age": 60,
        "gender": "female",
        "is_child": false,
        "filename": "nv1.png",
        "portrait_prompt": "A cinematic portrait, straight-on medium close-up shot on 85mm lens. Subject is a 60-year-old Vietnamese elderly woman with silver hair in a simple bun, deeply wrinkled face showing years of hard work, kind warm eyes, dark weathered skin. Looking directly at camera with neutral expression. Bright studio lighting. Pure white studio background. Wearing traditional dark brown ao ba ba. 8K, sharp focus, photorealistic.",
        "character_lock": "60-year-old Vietnamese elderly mother, silver hair in simple bun, deeply wrinkled weathered face, kind warm eyes, wearing dark brown ao ba ba traditional shirt"
      }},
      {{
        "id": "nvc1",
        "name": "Con trai nho",
        "role": "supporting",
        "age": 7,
        "gender": "male",
        "is_child": true,
        "filename": "NONE",
        "portrait_prompt": "DO_NOT_GENERATE",
        "character_lock": "7-year-old Vietnamese village boy, short black hair, round innocent face, wearing simple faded t-shirt and shorts"
      }}
    ],

    "locations": [
      {{
        "id": "loc1",
        "name": "Nha tranh nong thon",
        "filename": "loc1.png",
        "location_prompt": "Interior wide shot of humble Vietnamese rural home from 1990s. Empty room, no people. Simple wooden walls, thatched roof visible, earthen floor, bamboo furniture, old wooden bed with mosquito net, faded family photos on wall, altar with incense, warm golden afternoon light streaming through window. Cinematic, 4K photorealistic, warm earthy tones. 8K, rustic aesthetic.",
        "location_lock": "Humble 1990s Vietnamese rural home interior, wooden walls, bamboo furniture, earthen floor, old photos on wall, warm golden afternoon light through window",
        "lighting_default": "Warm golden afternoon light through small window"
      }},
      {{
        "id": "loc2",
        "name": "San nha nong thon",
        "filename": "loc2.png",
        "location_prompt": "Exterior wide shot of Vietnamese rural home courtyard from 1990s. Empty, no people. Dirt yard, simple wooden house with thatched roof, banana trees, well with bucket, chickens area, worn wooden bench, clothes drying on line, surrounding rice paddies visible. Warm golden hour lighting. Cinematic, 4K photorealistic. 8K.",
        "location_lock": "1990s Vietnamese rural courtyard, dirt yard, thatched roof house, banana trees, well, worn wooden bench, rice paddies in background, golden hour light",
        "lighting_default": "Warm golden hour sunlight, long shadows"
      }}
    ],

    "key_objects": []
  }}

  ## VI DU 2 - TRUYEN THANH THI HIEN DAI:
  Neu cau chuyen ve cuoc song van phong thanh pho, thi:
  - world_setting.setting = "Thanh thi Sai Gon hien dai"
  - characters: mac ao so mi, vest, trang phuc cong so
  - locations: van phong kinh, chung cu cao cap, quan cafe hien dai

  ## VI DU 3 - TRUYEN THOI XUA:
  Neu cau chuyen ve thoi phong kien, thi:
  - world_setting.era = "Thoi Nguyen 1800s"
  - characters: mac ao dai, khan dong, ao tu than
  - locations: nha ruong, san dinh lang, chua co

  ## QUY TAC BAT BUOC:
  1. BUOC 1 - PHAI phan tich world_setting TRUOC KHI tao nhan vat/boi canh
  2. NHAN VAT + BOI CANH PHAI DONG NHAT voi world_setting (cung thoi dai, cung phong cach, cung tone mau)
  3. PHAI trich xuat TAT CA nhan vat duoc nhac den trong truyen (ke ca chi xuat hien 1 lan)
  4. PHAI trich xuat TAT CA boi canh/dia diem duoc nhac den trong truyen
  5. character_lock PHAI co: Ten + Tuoi + Gioi tinh + Dac diem khuon mat + Toc + Da + TRANG PHUC (phu hop world_setting!)
  6. location_lock PHAI co: Loai dia diem + Cac vat the chinh + Anh sang (phu hop world_setting!)
  7. portrait_prompt: PHAI co "Pure white studio background", "neutral expression", "looking directly at camera"
  8. location_prompt: PHAI co "Empty room, no people"
  9. Tre em (is_child=true): portrait_prompt = "DO_NOT_GENERATE", filename = "NONE"
  10. ID format: nvc (nhan vat chinh/narrator), nv1, nv2... (phu), nvc1, nvc2... (tre em), loc1, loc2... (boi canh)
  11. filename DUNG .png (KHONG DUNG .jpg)
  12. Chi tra ve JSON thuan, KHONG co markdown code block

  ## KIEM TRA TINH DONG NHAT:
  Truoc khi tra ve, kiem tra:
  - Nhan vat co TRANG PHUC phu hop voi world_setting khong?
  - Boi canh co VAT THE phu hop voi world_setting khong?
  - Tat ca co TONE MAU thong nhat khong?

  Vi du KHONG DONG NHAT (SAI):
  - world_setting = "1990s nong thon ngheo" + nhan vat mac "vest suit hien dai" ❌
  - world_setting = "thanh thi Sai Gon" + boi canh "nha tranh mai la" ❌

# =============================================================================
# STEP 3: SCENE PRODUCTION (Tao prompt cho tung scene)
# =============================================================================
# Input: {characters_info}, {locations_info}, {pacing_script}, {global_style}
# Output: JSON array cua scenes
# =============================================================================

generate_scenes: |
  Ban la AI Production Director. Tao visual prompt cho tung scene, SU DUNG ANH THAM CHIEU (reference images).

  ## NGUYEN TAC BAT BUOC:

  ### 1. SCENE LA HANH DONG, KHONG PHAI PORTRAIT:
  - Nhan vat DANG LAM GI DO - khong phai dung pose
  - KHONG BAO GIO nhin thang vao camera
  - KHONG dung "looking at camera", "facing viewer", "portrait"
  - Mo ta HANH DONG: dang di, dang noi, dang nghi, dang lam viec...

  ### 2. SU DUNG THAM CHIEU DUNG CACH:
  - **character_lock**: Chi dung MO TA NGOAI HINH (tuoi, toc, mat, quan ao)
  - KHONG copy phan "looking at camera" tu portrait prompt
  - Them HANH DONG vao sau mo ta ngoai hinh
  - Vi du: "Minh, 32 tuoi, toc den ngan... DANG NGOI DOC SACH"

  ### 3. MOI SCENE = 1 KHOANH KHAC:
  - Moi scene trong input = 1 scene output
  - Mo ta KHOANH KHAC cu the trong cau chuyen

  ### 4. LOCATION + LIGHTING:
  - **location_lock**: COPY NGUYEN VAN lam background
  - Them anh sang phu hop voi thoi diem trong ngay

  ### 5. GLOBAL STYLE INJECTION:
  - Ket thuc moi img_prompt bang global_style string

  ## INPUT DATA:
  **GLOBAL_STYLE:** {global_style}

  **CHARACTERS (Chi dung phan mo ta ngoai hinh, BO QUA "looking at camera"):**
  {characters_info}

  **LOCATIONS (Dung location_lock nguyen van):**
  {locations_info}

  **SCENES (Noi dung can tao prompt - TAP TRUNG VAO HANH DONG):**
  (Moi scene da co Location - PHAI dung location_id do cho location_used!)
  {scenes_info}

  ## OUTPUT FORMAT - JSON ARRAY:

  Tra ve JSON object voi key "scenes" chua array:

  {{
    "scenes": [
      {{
        "scene_id": 1,
        "characters_used": ["nv1"],
        "location_used": "loc1",
        "reference_files": ["nv1.png", "loc1.png"],
        "img_prompt": "Wide shot, 24mm lens. Minh, 32-year-old Vietnamese man with short black side-parted hair, oval face, light tan skin, wearing navy blue polo shirt, WALKING SLOWLY toward the window, his back partially turned to viewer. Modern apartment living room, beige sofa, wooden coffee table, large window with city view, warm afternoon sunlight streaming in. Cinematic, 4K photorealistic, shot on Arri Alexa, soft film grain, natural lighting.",
        "video_prompt": "Slow tracking shot following Minh as he walks to window."
      }},
      {{
        "scene_id": 2,
        "characters_used": ["nv1", "nv2"],
        "location_used": "loc1",
        "reference_files": ["nv1.png", "nv2.png", "loc1.png"],
        "img_prompt": "Over-the-shoulder shot from behind Lan, 50mm lens. Minh, 32-year-old Vietnamese man with short black side-parted hair, sitting on beige sofa, LEANING FORWARD while speaking, hands gesturing. In soft focus foreground: back of Lan's head, long black hair. Two people in conversation. Modern apartment living room, warm afternoon light. Cinematic, 4K photorealistic, natural lighting.",
        "video_prompt": "Minh speaks animatedly, hands moving to emphasize points."
      }},
      {{
        "scene_id": 3,
        "characters_used": ["nv1"],
        "location_used": "loc1",
        "reference_files": ["nv1.png", "loc1.png"],
        "img_prompt": "Extreme close-up, 100mm macro lens. Minh's hands CLENCHING into fists on his lap, knuckles whitening, wedding ring visible. Shallow depth of field. Warm afternoon lighting. Cinematic, 4K photorealistic.",
        "video_prompt": "The hands slowly tighten, tension building."
      }}
    ]
  }}

  ## HANH DONG GUIDE (Thay vi pose):
  - Sad/Thinking: nhin ra cua so, cui dau, tay om mat
  - Happy: cuoi voi nguoi khac, om, bat tay
  - Angry: nam dam, dung day, quay lung
  - Talking: nghieng nguoi, dua tay, nhin nguoi doi dien
  - Walking: dang buoc di, lung quay lai
  - Working: dang viet, dang doc, dang lam viec

  ## KHONG DUOC LAM:
  - KHONG: "looking at camera", "facing viewer", "portrait shot"
  - KHONG: "neutral expression", "standing straight"
  - KHONG: nhan vat dung yen khong lam gi

  OUTPUT: JSON object voi key "scenes", KHONG co markdown code block.

# =============================================================================
# STEP 2.5: SMART SCENE DIVISION (Chia scene theo noi dung)
# =============================================================================
# Input: {srt_with_timestamps} - SRT entries voi timestamps
# Output: JSON array cua scenes duoc chia theo noi dung
# =============================================================================

smart_divide_scenes: |
  Ban la AI Director. Phan tich NOI DUNG va tao VISUAL MOMENT the hien dung noi dung do.

  ## CONTEXT - NHAN VAT VA BOI CANH DA XAC DINH:
  {characters_info}

  {locations_info}

  ## INPUT - Cac scene da chia (max 8s/scene):
  ---
  {srt_with_timestamps}
  ---

  ## NHIEM VU CHINH:
  1. Doc NOI DUNG moi scene
  2. Xac dinh NHAN VAT nao xuat hien (dung ID tu danh sach tren)
  3. Xac dinh BOI CANH dang o dau (dung ID tu danh sach tren, hoac tao moi neu chua co)
  4. Tao VISUAL MOMENT mo ta CHINH XAC hinh anh the hien noi dung do

  ## CACH TAO VISUAL MOMENT:
  Visual moment = Mo ta HINH ANH cu the the hien NOI DUNG doan van:
  - PHAI co nhan vat dang LAM GI (hanh dong, khong phai portrait)
  - PHAI the hien CAM XUC/TINH HUONG trong noi dung
  - PHAI co BOI CANH phu hop

  Vi du:
  - Noi dung: "Toi ngoi tren bac them toa an, tay run run cam ho so. Me toi la nguoi da hy sinh tat ca cho toi."
  - Visual: "Medium shot, nguoi dan ong ngoi co don tren bac them toa an, dau cui xuong nhin tap ho so trong tay run ray, ve mat buon ba, anh chieu ta xuong"

  - Noi dung: "Khi toi con nho, hai me con chi co nhau, toi nghi rang moi lien ket do se khong bao gio bi pha vo."
  - Visual: "Wide shot hoi tuong, nguoi me tre dan tay dua con nho di tren con duong que, anh hoang hon am ap, khong gian yeu thuong"

  ## OUTPUT FORMAT - JSON:

  {{
    "scenes": [
      {{
        "scene_id": 1,
        "location_id": "loc1",
        "characters_in_scene": ["nv1"],
        "shot_type": "Medium shot",
        "visual_moment": "Medium shot nguoi dan ong ngoi co don tren bac them toa an, dau cui nhin ho so, ve mat lo lang"
      }},
      {{
        "scene_id": 2,
        "location_id": "loc1",
        "characters_in_scene": ["nv1"],
        "shot_type": "Close-up",
        "visual_moment": "Close-up doi tay run ray nam chat tap ho so, ngon tay trang bech vi cang thang"
      }},
      {{
        "scene_id": 3,
        "location_id": "loc2",
        "characters_in_scene": ["nv1", "nv2"],
        "shot_type": "Wide shot",
        "visual_moment": "Wide shot hoi tuong - nguoi me tre dan tay con trai nho di tren duong que, anh hoang hon"
      }}
    ]
  }}

  ## QUY TAC BAT BUOC:
  1. scene_id PHAI KHOP voi so thu tu input (1, 2, 3...)
  2. visual_moment PHAI the hien DUNG noi dung cua scene (khong chung chung)
  3. characters_in_scene chi chua ID nhan vat THUC SU xuat hien trong scene
  4. location_id dung ID da cho, hoac tao moi neu chua co (loc1, loc2...)
  5. KHONG mo ta portrait (khong nhin camera, khong dung yen)

  ## GOC MAY:
  - Wide shot: Thiet lap boi canh, hoi tuong
  - Medium shot: Hanh dong chinh
  - Close-up: Cam xuc, chi tiet
  - OTS: Doi thoai 2 nguoi

  OUTPUT: JSON object, KHONG markdown.

# =============================================================================
# CAMERA REFERENCE
# =============================================================================

camera_reference:
  shot_types:
    "Extreme Wide Shot (EWS)": "Environment dominant, tiny subject"
    "Wide Shot (WS)": "Full body + environment"
    "Medium Shot (MS)": "Waist up"
    "Medium Close-up (MCU)": "Chest up"
    "Close-up (CU)": "Face fills frame"
    "Extreme Close-up (ECU)": "Part of face/detail"
    "Over-the-shoulder (OTS)": "Behind one person looking at another"
    "Two-shot": "Two people in frame"

  angles:
    "Eye-level": "Neutral, viewer = observer"
    "Low angle": "Subject has power, heroic"
    "High angle": "Subject vulnerable, small"
    "Dutch tilt": "Unease, tension"
    "Over-the-shoulder": "Connection, conversation"

  lenses:
    "24mm": "Wide - Establishing, environments"
    "35mm": "Wide normal - Full body, groups"
    "50mm": "Normal - Dialogue, versatile"
    "85mm": "Portrait - Face detail, interviews"
    "100mm": "Macro - Details, hands, objects"

# =============================================================================
# END v5.0
# =============================================================================
